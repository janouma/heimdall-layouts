import{SvelteElement,append,attr,attribute_to_object,binding_callbacks,destroy_block,detach,element,flush,init,insert,listen,noop,not_equal,run_all,set_custom_element_data,set_input_value,set_style,space,toggle_class,update_keyed_each}from"../../packages/svelte/internal/index.mjs";import{onDestroy}from"../../packages/svelte/internal/index.mjs";import Fuse from"../../packages/fuse.js/dist/fuse.basic.esm.min.js";import addAdaptiveBehaviour from"../../packages/element-adapter/dist/element-adapter.esm.js";import"../word_tag/index.js";function get_each_context(e,t,a){const i=e.slice();return i[29]=t[a],i}function get_each_context_1(e,t,a){const i=e.slice();return i[29]=t[a],i}function create_if_block(e){let t;return{c(){t=element("div"),t.innerHTML='<word-tag label="dummy"></word-tag>',attr(t,"class","width-lte-382px"),set_style(t,"display","none")},m(e,a){insert(e,t,a)},d(e){e&&detach(t)}}}function create_each_block_1(e,t){let a,i,n,s;return{key:e,first:null,c(){a=element("word-tag"),set_custom_element_data(a,"class","sky"),set_custom_element_data(a,"label",i=t[29]),set_custom_element_data(a,"disabled",t[1]),set_custom_element_data(a,"thik",t[2]),this.first=a},m(e,i){insert(e,a,i),n||(s=listen(a,"remove",t[9]),n=!0)},p(e,n){t=e,32&n[0]&&i!==(i=t[29])&&set_custom_element_data(a,"label",i),2&n[0]&&set_custom_element_data(a,"disabled",t[1]),4&n[0]&&set_custom_element_data(a,"thik",t[2])},d(e){e&&detach(a),n=!1,s()}}}function create_each_block(e,t){let a,i,n,s,r;return{key:e,first:null,c(){a=element("word-tag"),set_custom_element_data(a,"label",i=t[29]),set_custom_element_data(a,"readonly",n=!0),set_custom_element_data(a,"disabled",t[1]),set_custom_element_data(a,"thik",t[2]),this.first=a},m(e,i){insert(e,a,i),s||(r=listen(a,"select",t[11]),s=!0)},p(e,n){t=e,64&n[0]&&i!==(i=t[29])&&set_custom_element_data(a,"label",i),2&n[0]&&set_custom_element_data(a,"disabled",t[1]),4&n[0]&&set_custom_element_data(a,"thik",t[2])},d(e){e&&detach(a),s=!1,r()}}}function create_fragment(e){let t,a,i,n,s,r,o,l,d=[],c=new Map,m=[],g=new Map,u=!1,h=e[5];const p=e=>e[29];for(let t=0;t<h.length;t+=1){let a=get_each_context_1(e,h,t),i=p(a);c.set(i,d[t]=create_each_block_1(i,a))}let _=e[6];const b=e=>e[29];for(let t=0;t<_.length;t+=1){let a=get_each_context(e,_,t),i=b(a);g.set(i,m[t]=create_each_block(i,a))}return{c(){u&&u.c(),t=space(),a=element("div");for(let e=0;e<d.length;e+=1)d[e].c();i=space(),n=element("input"),s=space(),r=element("div");for(let e=0;e<m.length;e+=1)m[e].c();this.c=noop,attr(n,"class","border-none border-box m0 p0 bold no-focus bg-transparent animated capitalize sky"),attr(n,"name","tag"),attr(n,"pattern",TAG_PATTERN),attr(n,"type","text"),attr(n,"minlength","2"),attr(n,"maxlength","15"),attr(n,"autocorrect","off"),attr(n,"autocomplete","off"),attr(n,"spellcheck","false"),attr(n,"placeholder",e[0]),n.disabled=e[1],toggle_class(n,"thik",e[2]),toggle_class(n,"invalid",e[7]),attr(a,"class","flex flex-wrap items-center box-underline"),attr(r,"class","tag-growth flex flex-wrap items-center")},m(c,g){u&&u.m(c,g),insert(c,t,g),insert(c,a,g);for(let e=0;e<d.length;e+=1)d[e]&&d[e].m(a,null);append(a,i),append(a,n),set_input_value(n,e[4]),e[27](a),insert(c,s,g),insert(c,r,g);for(let e=0;e<m.length;e+=1)m[e]&&m[e].m(r,null);o||(l=[listen(n,"input",e[26]),listen(n,"keyup",e[8]),listen(n,"keydown",e[10])],o=!0)},p(e,t){550&t[0]&&(h=e[5],d=update_keyed_each(d,t,p,1,e,h,c,a,destroy_block,create_each_block_1,i,get_each_context_1)),1&t[0]&&attr(n,"placeholder",e[0]),2&t[0]&&(n.disabled=e[1]),16&t[0]&&n.value!==e[4]&&set_input_value(n,e[4]),4&t[0]&&toggle_class(n,"thik",e[2]),128&t[0]&&toggle_class(n,"invalid",e[7]),2118&t[0]&&(_=e[6],m=update_keyed_each(m,t,b,1,e,_,g,r,destroy_block,create_each_block,null,get_each_context))},i:noop,o:noop,d(i){u&&u.d(i),i&&detach(t),i&&detach(a);for(let e=0;e<d.length;e+=1)d[e].d();e[27](null),i&&detach(s),i&&detach(r);for(let e=0;e<m.length;e+=1)m[e].d();o=!1,run_all(l)}}}const COMPLETION_MAX_LEN=5,TAG_SPACE_CATCHER=/\s+/g,TAG_PATTERN="^[\\w -]{2,}$",SEARCH_OPTS={shouldSort:!0,tokenize:!0,matchAllTokens:!0,threshold:.3,location:0,maxPatternLength:32,keys:["name","aliases"]},deserializeArray=e=>"string"==typeof e?e.split(","):e,deserializeObject=e=>"string"==typeof e?JSON.parse(e):e,safeIncludes=(e,t)=>e&&e.includes(t),safeGet=(e,t,a)=>e&&e[t]||a,isSameContent=(e,t)=>String(e)===String(t);function instance(e,t,a){let i,n,s,r,o,l,d,c,m,{placeholder:g=""}=t,{tags:u}=t,{aliases:h}=t,{preselectedtags:p}=t,{excludedtags:_}=t,{disabled:b}=t,{thik:f}=t;const y={};let v,$,k,w,x,A;return onDestroy((()=>v?.())),e.$$set=e=>{"placeholder"in e&&a(0,g=e.placeholder),"tags"in e&&a(12,u=e.tags),"aliases"in e&&a(13,h=e.aliases),"preselectedtags"in e&&a(14,p=e.preselectedtags),"excludedtags"in e&&a(15,_=e.excludedtags),"disabled"in e&&a(1,b=e.disabled),"thik"in e&&a(2,f=e.thik)},e.$$.update=()=>{if(8&e.$$.dirty[0]&&a(24,i=$?.parentNode.host),4096&e.$$.dirty[0]&&a(21,n=deserializeObject(u)),8192&e.$$.dirty[0]&&a(22,s=deserializeObject(h)),32768&e.$$.dirty[0]&&a(20,r=deserializeArray(_)),16384&e.$$.dirty[0]&&a(17,w=p&&deserializeArray(p)),131072&e.$$.dirty[0]&&a(5,o=w||[]),16&e.$$.dirty[0]&&a(23,l=k?.trim()),13631488&e.$$.dirty[0])if(l&&l.match(TAG_PATTERN)){const e=l.toLowerCase().replace(TAG_SPACE_CATCHER," ");safeIncludes(r,e)?a(18,x=void 0):a(18,x=safeGet(s,e,e))}else a(18,x=void 0);if(262160&e.$$.dirty[0]&&a(7,d=k&&!x),8&e.$$.dirty[0]&&$&&window.requestAnimationFrame((()=>{({removeAdaptiveBehaviour:v}=addAdaptiveBehaviour({target:$,queries:{"width-lte-382px":"width <= 382px"}}))})),2097184&e.$$.dirty[0]&&a(25,c=n&&n.filter((({name:e,preset:t})=>t&&!o.includes(e))).slice(0,5).map((({name:e})=>e))),3407904&e.$$.dirty[0])if(x){const e=n&&n.filter((({name:e})=>!o.includes(e)&&!safeIncludes(r,e)));if(e){const t=new Fuse(e,SEARCH_OPTS).search(x).map((({item:{name:e}})=>e)),i=Array.from(new Set(t));a(19,A=i.length<=5&&i)}}else a(19,A=void 0);if(42467328&e.$$.dirty[0]&&a(6,m=A||!l&&c||[]),16990208&e.$$.dirty[0]&&w){if(!p||"selectedTags"in y&&!isSameContent(w,y.selectedTags)){const e=new window.CustomEvent("change",{detail:w,bubbles:!1});i.dispatchEvent(e)}a(16,y.selectedTags=w,y)}},[g,b,f,$,k,o,m,d,function({key:e}){"Enter"===e&&x&&(a(4,k=""),o.includes(x)||a(17,w=[...o,x]))},function({detail:e}){const t=o.indexOf(e);t>-1&&a(17,w=[...w.slice(0,t),...w.slice(t+1)])},function({key:e}){if("Backspace"===e&&!k&&o.length>0){const e=Array.from(w);a(4,k=e.pop()),a(17,w=e)}},function({detail:e}){a(17,w=[...o,e]),a(4,k="")},u,h,p,_,y,w,x,A,r,n,s,l,i,c,function(){k=this.value,a(4,k)},function(e){binding_callbacks[e?"unshift":"push"]((()=>{$=e,a(3,$)}))}]}class Tag_input extends SvelteElement{constructor(e){super();const t=document.createElement("style");t.textContent=".bold{font-weight:700;font-weight:bold;font-weight:var(--bold-font-weight,bold)}.border-box{box-sizing:border-box}.m0{margin:0}.p0{padding:0}@media(min-width:40em){}@media(min-width:52em){}@media(min-width:64em){}.flex{display:flex}@media(min-width:40em){}@media(min-width:52em){}@media(min-width:64em){}.flex-wrap{flex-wrap:wrap}.items-center{align-items:center}.border-none{border:0}@media(max-width:40em){}@media(min-width:40em) and (max-width:52em){}@media(min-width:52em) and (max-width:64em){}@media(min-width:64em){}.no-focus:focus,:focus{outline:0;box-shadow:none}[disabled]:not(.not-visible){opacity:0.5}[disabled]:not(.not-visible){cursor:not-allowed}input{border-radius:0;font-family:'Hasteristico', 'heimdall-widget-base-font';letter-spacing:0.05em;color:var(--font-color)}input:invalid,input.invalid{color:rgb(255,85,112);color:rgb(var(--pinkred))}input::-moz-placeholder{color:rgba(235,235,235, 0.35);color:rgba(var(--eggshell), 0.35);transition-duration:var(--anim-duration);transition-timing-function:ease-in-out;-moz-transition-property:color;transition-property:color}input::placeholder{color:rgba(235,235,235, 0.35);color:rgba(var(--eggshell), 0.35);transition-duration:var(--anim-duration);transition-timing-function:ease-in-out;transition-property:color}input:focus::-moz-placeholder{color:rgba(235,235,235, 0.2);color:rgba(var(--eggshell), 0.2)}input:focus::placeholder{color:rgba(235,235,235, 0.2);color:rgba(var(--eggshell), 0.2)}.box-underline{--stop:0.36rem;--opacity:0.3;background-image:linear-gradient(to top, rgba(187,183,76, var(--opacity)), rgba(187,183,76, var(--opacity)) var(--stop), transparent var(--stop));background-image:linear-gradient(to top, rgba(var(--gold), var(--opacity)), rgba(var(--gold), var(--opacity)) var(--stop), transparent var(--stop))}:host{--anim-duration:0.25s}:where(.animated){transition-duration:var(--anim-duration);transition-timing-function:ease-in-out;transition-property:color, background-color, opacity, visibility, height, width, transform, \n    transform-origin, filter, left, top, right, no-prop}.capitalize{text-transform:capitalize}.bg-transparent{background-color:transparent}.sky{color:rgb(88,146,246);color:rgb(var(--sky))}:host{--anim-duration:0.25s;--tag-vmargin:0.175em;--font-color:rgb(var(--eggshell))\n  }:host>.box-underline{margin-bottom:0.35em}:host>.box-underline>input{letter-spacing:0.0465em;height:1.65em;font-size:2em}.sky{color:rgb(88,146,246);color:rgb(var(--sky))}.bg-transparent{background-color:transparent}word-tag{margin:var(--tag-vmargin) 1.25em var(--tag-vmargin) 0}.width-lte-382px>word-tag{font-size:1.5em}.tag-growth{font-size:1.12em;min-height:var(--tag-vmargin)\n  }.tag-growth:not(:empty){margin-top:0.98em}.thik{min-height:2.5em}input{flex-basis:0;flex-grow:1;min-width:33%}input:not(:invalid):not(:-moz-placeholder-shown){background:url(https://janouma.github.io/heimdall-layouts/shared_components/tag_input/assets/images/enter_key.svg) no-repeat right calc(50% - 0.125em)/1em}input:not(:invalid):not(:placeholder-shown){background:url(https://janouma.github.io/heimdall-layouts/shared_components/tag_input/assets/images/enter_key.svg) no-repeat right calc(50% - 0.125em)/1em}",this.shadowRoot.appendChild(t),init(this,{target:this.shadowRoot,props:attribute_to_object(this.attributes),customElement:!0},instance,create_fragment,not_equal,{placeholder:0,tags:12,aliases:13,preselectedtags:14,excludedtags:15,disabled:1,thik:2},null,[-1,-1]),e&&(e.target&&insert(e.target,this,e.anchor),e.props&&(this.$set(e.props),flush()))}static get observedAttributes(){return["placeholder","tags","aliases","preselectedtags","excludedtags","disabled","thik"]}get placeholder(){return this.$$.ctx[0]}set placeholder(e){this.$$set({placeholder:e}),flush()}get tags(){return this.$$.ctx[12]}set tags(e){this.$$set({tags:e}),flush()}get aliases(){return this.$$.ctx[13]}set aliases(e){this.$$set({aliases:e}),flush()}get preselectedtags(){return this.$$.ctx[14]}set preselectedtags(e){this.$$set({preselectedtags:e}),flush()}get excludedtags(){return this.$$.ctx[15]}set excludedtags(e){this.$$set({excludedtags:e}),flush()}get disabled(){return this.$$.ctx[1]}set disabled(e){this.$$set({disabled:e}),flush()}get thik(){return this.$$.ctx[2]}set thik(e){this.$$set({thik:e}),flush()}}customElements.define("tag-input",Tag_input);export default Tag_input;