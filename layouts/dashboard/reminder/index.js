import{SvelteElement,append,assign,attr,attribute_to_object,binding_callbacks,destroy_each,detach,element,empty,flush,get_spread_update,init,insert,is_function,listen,noop,not_equal,set_data,set_dynamic_element_data,set_style,space,src_url_equal,text,toggle_class}from"../../../packages/svelte/internal/index.mjs";import"../../../packages/joi-browser.min.js";import{onDestroy}from"../../../packages/svelte/internal/index.mjs";import{render as renderMessage}from"../../../packages/@heimdall/utils/lib/template_string.mjs";import{debounce}from"../../../packages/@heimdall/utils/lib/function.mjs";import{createValidator}from"../../../lib/validation.js";import{getActionTag,isLink,dispatchContentDisplayEvent}from"../../../lib/item.js";function get_each_context(e,t,n){const r=e.slice();return r[21]=t[n],r}function get_each_context_1(e,t,n){const r=e.slice();return r[24]=t[n],r}function create_if_block_1(e){let t,n=e[0],r=[];for(let t=0;t<n.length;t+=1)r[t]=create_each_block_1(get_each_context_1(e,n,t));return{c(){for(let e=0;e<r.length;e+=1)r[e].c();t=empty()},m(e,n){for(let t=0;t<r.length;t+=1)r[t]&&r[t].m(e,n);insert(e,t,n)},p(e,o){if(323&o){let i;for(n=e[0],i=0;i<n.length;i+=1){const a=get_each_context_1(e,n,i);r[i]?r[i].p(a,o):(r[i]=create_each_block_1(a),r[i].c(),r[i].m(t.parentNode,t))}for(;i<r.length;i+=1)r[i].d(1);r.length=n.length}},d(e){destroy_each(r,e),e&&detach(t)}}}function create_if_block_3(e){let t,n,r;return{c(){t=element("img"),attr(t,"class","snapshot stretch"),src_url_equal(t.src,n=e[24].snapshot)||attr(t,"src",n),attr(t,"alt",r=`${e[1]?.snapshotalt} "${e[24].title}"`),set_style(t,"--blur",e[6])},m(e,n){insert(e,t,n)},p(e,o){1&o&&!src_url_equal(t.src,n=e[24].snapshot)&&attr(t,"src",n),3&o&&r!==(r=`${e[1]?.snapshotalt} "${e[24].title}"`)&&attr(t,"alt",r),64&o&&set_style(t,"--blur",e[6])},d(e){e&&detach(t)}}}function create_if_block_2(e){let t,n,r;return{c(){t=element("img"),attr(t,"class","icon"),src_url_equal(t.src,n=e[24].icon)||attr(t,"src",n),attr(t,"alt",r=`${e[1]?.iconalt} "${e[24].title}"`)},m(e,n){insert(e,t,n)},p(e,o){1&o&&!src_url_equal(t.src,n=e[24].icon)&&attr(t,"src",n),3&o&&r!==(r=`${e[1]?.iconalt} "${e[24].title}"`)&&attr(t,"alt",r)},d(e){e&&detach(t)}}}function create_dynamic_element(e){let t,n,r,o,i,a,s,l,c=e[24].title+"",d=e[24].snapshot&&create_if_block_3(e),g=e[24].icon&&create_if_block_2(e),m=[{href:a=isLink(e[24])?e[24].url:void 0},{rel:"noopener"},{target:"_blank"},{class:"stretch action"}],h={};for(let e=0;e<m.length;e+=1)h=assign(h,m[e]);return{c(){t=element(getActionTag(e[24])),d&&d.c(),n=space(),r=element("h2"),o=text(c),i=space(),g&&g.c(),attr(r,"class","hstretch"),set_dynamic_element_data(getActionTag(e[24]))(t,h)},m(a,c){insert(a,t,c),d&&d.m(t,null),append(t,n),append(t,r),append(r,o),append(r,i),g&&g.m(r,null),s||(l=listen(t,"click",(function(){is_function(isLink(e[24])?void 0:e[8](e[24]))&&(isLink(e[24])?void 0:e[8](e[24])).apply(this,arguments)})),s=!0)},p(i,s){(e=i)[24].snapshot?d?d.p(e,s):(d=create_if_block_3(e),d.c(),d.m(t,n)):d&&(d.d(1),d=null),1&s&&c!==(c=e[24].title+"")&&set_data(o,c),e[24].icon?g?g.p(e,s):(g=create_if_block_2(e),g.c(),g.m(r,null)):g&&(g.d(1),g=null),set_dynamic_element_data(getActionTag(e[24]))(t,h=get_spread_update(m,[1&s&&a!==(a=isLink(e[24])?e[24].url:void 0)&&{href:a},{rel:"noopener"},{target:"_blank"},{class:"stretch action"}]))},d(e){e&&detach(t),d&&d.d(),g&&g.d(),s=!1,l()}}}function create_each_block_1(e){let t,n,r=getActionTag(e[24]),o=getActionTag(e[24])&&create_dynamic_element(e);return{c(){t=element("li"),o&&o.c(),n=space()},m(e,r){insert(e,t,r),o&&o.m(t,null),append(t,n)},p(e,i){getActionTag(e[24])?r?not_equal(r,getActionTag(e[24]))?(o.d(1),o=create_dynamic_element(e),r=getActionTag(e[24]),o.c(),o.m(t,n)):o.p(e,i):(o=create_dynamic_element(e),r=getActionTag(e[24]),o.c(),o.m(t,n)):r&&(o.d(1),o=null,r=getActionTag(e[24]))},d(e){e&&detach(t),o&&o.d(e)}}}function create_if_block(e){let t,n=createRange(0,e[5],!1),r=[];for(let t=0;t<n.length;t+=1)r[t]=create_each_block(get_each_context(e,n,t));return{c(){t=element("nav");for(let e=0;e<r.length;e+=1)r[e].c()},m(e,n){insert(e,t,n);for(let e=0;e<r.length;e+=1)r[e]&&r[e].m(t,null)},p(e,o){if(178&o){let i;for(n=createRange(0,e[5],!1),i=0;i<n.length;i+=1){const a=get_each_context(e,n,i);r[i]?r[i].p(a,o):(r[i]=create_each_block(a),r[i].c(),r[i].m(t,null))}for(;i<r.length;i+=1)r[i].d(1);r.length=n.length}},d(e){e&&detach(t),destroy_each(r,e)}}}function create_each_block(e){let t,n,r,o,i;function a(){return e[13](e[21])}return{c(){t=element("button"),attr(t,"class","animated"),t.disabled=n=e[4]===e[21],attr(t,"title",r=e[1]&&renderMessage(e[1].navButtonTitle,{page:e[21]+1})),toggle_class(t,"current",e[4]===e[21])},m(e,n){insert(e,t,n),o||(i=listen(t,"click",a),o=!0)},p(o,i){e=o,48&i&&n!==(n=e[4]===e[21])&&(t.disabled=n),34&i&&r!==(r=e[1]&&renderMessage(e[1].navButtonTitle,{page:e[21]+1}))&&attr(t,"title",r),48&i&&toggle_class(t,"current",e[4]===e[21])},d(e){e&&detach(t),o=!1,i()}}}function create_fragment(e){let t,n,r,o=e[0]?.length>0&&create_if_block_1(e),i=e[5]>1&&create_if_block(e);return{c(){t=element("ul"),o&&o.c(),n=space(),i&&i.c(),r=empty(),this.c=noop,set_style(t,"--page-size",e[3])},m(a,s){insert(a,t,s),o&&o.m(t,null),e[12](t),insert(a,n,s),i&&i.m(a,s),insert(a,r,s)},p(e,[n]){e[0]?.length>0?o?o.p(e,n):(o=create_if_block_1(e),o.c(),o.m(t,null)):o&&(o.d(1),o=null),8&n&&set_style(t,"--page-size",e[3]),e[5]>1?i?i.p(e,n):(i=create_if_block(e),i.c(),i.m(r.parentNode,r)):i&&(i.d(1),i=null)},i:noop,o:noop,d(a){a&&detach(t),o&&o.d(),e[12](null),a&&detach(n),i&&i.d(a),a&&detach(r)}}}function createRange(e,t,n=!0){return Array.from({length:t+(n?1:0)-e},((t,n)=>n+e))}function round(e,t=0){const n=Math.max(1,10*t);return Math.round(e*n)/n}const BASE_SIZE=500,ANIMATION_DELAY=5e3,componentDisplayName="dashboard/reminder";function instance(e,t,n){let r,o,i,a,{items:s}=t,{messages:l}=t,c=1,d=0,g=0;const m={stopAnimation:void 0,resetAnimationTimer:void 0,debounceResetAnimationTimer:void 0},h=new window.ResizeObserver((e=>{const[{contentBoxSize:[{inlineSize:t}]}]=e;n(10,g=t),n(9,c=Math.floor(g/500)+Math.round(g%500/500)),_()})),{joi:u}=window,p=createValidator("dashboard/reminder"),b=debounce(_,50);function _(){const{scrollLeft:e,scrollWidth:t}=a;n(4,d=Math.round(e/t*o))}function f(e){v(e),m.resetAnimationTimer?.()}function v(e){const t=Math.round(e/o*a.scrollWidth);a.scrollTo({left:t,behavior:"smooth"}),n(4,d=Math.round(t/a.scrollWidth*o))}onDestroy((()=>{h.disconnect(),a.removeEventListener("scroll",b),m.debounceResetAnimationTimer&&(a.removeEventListener("wheel",m.debounceResetAnimationTimer),a.removeEventListener("touchstart",m.debounceResetAnimationTimer)),m.stopAnimation?.()}));return e.$$set=e=>{"items"in e&&n(0,s=e.items),"messages"in e&&n(1,l=e.messages)},e.$$.update=()=>{1&e.$$.dirty&&p(s,"items",u.array().items(u.object({$id:u.string().required(),title:u.string().required(),url:u.string(),snapshot:u.alternatives().try(u.string(),null),icon:u.alternatives().try(u.string(),null),type:u.string().valid("url","text","javascript","css","html","shell","python","json")}).unknown().required()).min(1)),2&e.$$.dirty&&p(l,"messages",u.object({navButtonTitle:u.string().required(),iconalt:u.string().required(),snapshotalt:u.string().required()})),513&e.$$.dirty&&n(3,r=Math.min(s?.length||1,c)),9&e.$$.dirty&&n(5,o=s?.length?Math.ceil(s?.length/r):0),1025&e.$$.dirty&&n(6,i=round(g/(500*(s?.length||1))/37.5,1)),2052&e.$$.dirty&&a&&(h.observe(a.parentNode.host),a.addEventListener("scroll",b),Object.assign(m,function(){const{requestAnimationFrame:e,cancelAnimationFrame:t}=window;let n,i;return i=e((function t(a){n??=a,a-n>=5e3*r&&(n=a,v((d+1)%o)),i=e(t)})),{stopAnimation(){t(i)},resetAnimationTimer(){n=void 0}}}()),n(11,m.debounceResetAnimationTimer=debounce(m.resetAnimationTimer,100),m),a.addEventListener("wheel",m.debounceResetAnimationTimer),a.addEventListener("touchstart",m.debounceResetAnimationTimer))},[s,l,a,r,d,o,i,f,function(e){dispatchContentDisplayEvent({node:a,item:e})},c,g,m,function(e){binding_callbacks[e?"unshift":"push"]((()=>{a=e,n(2,a)}))},e=>f(e)]}class Reminder extends SvelteElement{constructor(e){super();const t=document.createElement("style");t.textContent="html{--eggshell:235,235,235;--purple:40,16,98;--mauve:154,88,133;--pinkred:255,85,112;--red:255, 0, 0;--gold:187,183,76;--silvergold:237,233,126;--sky:88,146,246;--deepsky:20,48,151;--space:34,32,56;--deepspace:6,3,33;--grass:0,238,119;--transluent:rgba(255,255,255,0.12);--deepwater:51,50,77}body .hstretch,body>.hstretch,body .stretch,body>.stretch,:host .hstretch,:host .stretch{width:100%}body .stretch,body>.stretch,:host .stretch{height:100%}html,:host{--anim-duration:0.25s}:where(.animated){transition-duration:var(--anim-duration);transition-timing-function:ease-in-out;transition-property:color, background-color, opacity, visibility, height, width, transform, \n    transform-origin, filter, left, top, right, no-prop}:host{display:block;position:relative;height:min(26.385em, 90dvh);overflow:hidden\n  }:host,:host *{box-sizing:border-box}li>*,nav{box-shadow:0 0 1px 0 rgb(88,146,246), inset 0 0 1px 0 rgb(235,235,235);box-shadow:0 0 1px 0 rgb(var(--sky)), inset 0 0 1px 0 rgb(var(--eggshell))}ul{list-style:none;display:flex;overflow-y:hidden;overflow-x:auto;overscroll-behavior:none;padding:0;margin:0;height:100%;scrollbar-width:none;scroll-snap-type:x mandatory\n  }ul::-webkit-scrollbar{display:none}li{flex:none;width:calc(100% / var(--page-size));scroll-snap-align:start;padding-left:0.5em;padding-right:0.5em;padding-bottom:1.75em\n  }li>*{background-color:rgb(235,235,235);background-color:rgb(var(--eggshell));overflow:hidden;background:no-repeat center/cover url(https://janouma.github.io/heimdall-layouts/layouts/dashboard/reminder/assets/images/missing_snapshot.svg);border-radius:0.391em}li:nth-child(2n) h2{--fill-color:var(--eggshell);--color:var(--deepwater)}li:nth-child(2n + 1) h2{--fill-color:var(--deepspace);--color:var(--eggshell)}.snapshot{position:absolute;top:0;left:0;-o-object-position:center;object-position:center;-o-object-fit:cover;object-fit:cover;filter:blur(calc(var(--blur) * 1em))}h2{--gradient-size:3em;position:relative;background-image:linear-gradient(transparent, rgba(var(--fill-color), 90%) var(--gradient-size));height:calc(2.62em + var(--gradient-size));line-height:1.125;padding:0.25em 0.375em;padding-top:calc(0.25em + var(--gradient-size));margin:0;overflow:hidden;text-transform:capitalize;color:rgb(var(--color));letter-spacing:0.05em}nav{position:absolute;bottom:0;left:50%;translate:-50% 0;display:flex;justify-content:center;align-items:start;pointer-events:none;grid-column-gap:1em;-moz-column-gap:1em;column-gap:1em;padding:0.25em;background-color:rgba(51,50,77, 75%);background-color:rgba(var(--deepwater), 75%);border-radius:0.6875em\n  }nav button{padding:0;position:relative;pointer-events:auto;width:0.875em;aspect-ratio:1;border-radius:50%;background-color:rgb(235,235,235);background-color:rgb(var(--eggshell));border:none;box-shadow:0 0 1px 0 rgb(6,3,33);box-shadow:0 0 1px 0 rgb(var(--deepspace))\n    }nav button:not([disabled]){cursor:pointer}nav button.current{background-color:rgb(187,183,76);background-color:rgb(var(--gold))}nav button::after{--expanse:50%;content:'';position:absolute;top:0;left:0;width:100%;height:100%;border-radius:50%;margin:calc(-1 * var(--expanse));padding:var(--expanse)}@media(hover: none){nav{grid-column-gap:1.25em;-moz-column-gap:1.25em;column-gap:1.25em\n  }nav button::after{--expanse:75%}}.icon{position:absolute;top:1.5em;left:0.375em;width:1.042em;aspect-ratio:1;border-radius:50%;-o-object-fit:contain;object-fit:contain;box-sizing:border-box;border:1px solid rgb(88,146,246);border:1px solid rgb(var(--sky));box-shadow:0 0 0 1px rgb(34,32,56);box-shadow:0 0 0 1px rgb(var(--space));background-color:rgb(235,235,235);background-color:rgb(var(--eggshell));overflow:hidden}.action{display:flex;flex-direction:column;justify-content:flex-end;position:relative;text-decoration:none;padding:0;margin:0;border:none;font-family:inherit;font-size:inherit;background-color:transparent;cursor:pointer}",this.shadowRoot.appendChild(t),init(this,{target:this.shadowRoot,props:attribute_to_object(this.attributes),customElement:!0},instance,create_fragment,not_equal,{items:0,messages:1},null),e&&(e.target&&insert(e.target,this,e.anchor),e.props&&(this.$set(e.props),flush()))}static get observedAttributes(){return["items","messages"]}get items(){return this.$$.ctx[0]}set items(e){this.$$set({items:e}),flush()}get messages(){return this.$$.ctx[1]}set messages(e){this.$$set({messages:e}),flush()}}customElements.define("hdl-dashboard-reminder",Reminder);export default Reminder;